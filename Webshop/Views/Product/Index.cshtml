@inject Webshop.Services.ProductHandler _ProductHandler;
@using System.Collections
@using System.Diagnostics.Metrics
@using System.Runtime.CompilerServices
@using Webshop.Models
@model IList<Webshop.Models.Product>;

<style>
    body {
        background: #FBF8F1;
    }


    a,
    a:hover {
        text-decoration: none;
        color: inherit;
    }


    /* .section-products {
        
        margin-left: 5rem;
        margin-right: 5rem;
        padding: 80px 0 54px;
        background: #FBF8F1;
        /* background: rgb(186,109,84);
        background: linear-gradient(180deg, rgba(186,109,84,0.5552491260175945) 0%, rgba(0,212,255,0.14628554058342091) 100%);
        margin-bottom: 5rem;
        box-shadow: 1px 1px 5px black;
       
    }*/

        .section-products .header {
            margin-bottom: 50px;
        }

            .section-products .header h3 {
                font-size: 1rem;
                color: #fe302f;
                font-weight: 500;
            }

            .section-products .header h2 {
                font-size: 2.2rem;
                font-weight: 400;
                color: #444444;
            }
            .container {
                max-width: 80%;
            }
        .section-products .single-product {
            margin-bottom: 26px;
            
        }

            .section-products .single-product .part-1 {
                position: relative;
                display: flex;
                justify-content: center;
                height: 250px;
                max-height: 250px;
                max-width: 320px;
                margin-bottom: 20px;
                overflow: hidden;
            }

                .section-products .single-product .part-1::before {
                    position: absolute;
                    content: "";
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    z-index: -1;
                    transition: all 0.3s;
                  

                }

            .section-products .single-product:hover .part-1::before {
                transform: scale(1.2,1.2) rotate(5deg);
            }




            .section-products .single-product .part-1 .discount,
            .section-products .single-product .part-1 .new {
                position: absolute;
                top: 15px;
                left: 20px;
                color: #ffffff;
                background-color: #fe302f;
                padding: 2px 8px;
                text-transform: uppercase;
                font-size: 0.85rem;
            }

            .section-products .single-product .part-1 .new {
                left: 0;
                background-color: #444444;
            }

       
            .section-products .single-product .part-2 .product-title {
                font-size: 1rem;
            }

            .section-products .single-product .part-2 h4 {
                font-size: 0.9rem;
            }

    
            .part2 {
                min-height: 350px;
            }

    

    .header-img {
        background: url("/img/makeup.jpg");
        background-size: cover;
        background-repeat: no-repeat;
    }

    .img-product {
        /*border: 1px solid black;*/
        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
        max-width: 300px;
        max-height: 445px;
    }

    .bi-cart-fill {
        width: 10px;
        height: 10px;
    }
    .bi-star-fill {
        color: goldenrod;
      
    }

    .inner {
      
        position: absolute;
        
    }
    .btn {
        font-size: 1vw;
    }
    .hide{ 
        display: none;
    }
    .show:hover + .hide {
        display:block;
        color: red;
    }
  .btn-group {
      justify-items: self-start;
  }
    
   
</style>

@functions{
    
    void RatingStars(double? rating)
    {
        @if (rating > 5)
        {
            rating = 5;
        }
           
        <div class="my-1">
          
            @for (int i = 0; i < rating; i++)
            {
                <i class="bi bi-star-fill"></i>
            }
        </div>
        
    }


    async Task RenderMostPopular()
    {


        foreach (var product in @Model)
        {

            <!-- Single Product -->
            <div class="col-md-6 col-lg-4 col-xl-3">
                <div id="product-1 show" class="single-product">
                    
                    
                    
                    <div class="part-1 card ">
                        <div class="hide">
                            <a href="#"><i class="bi bi-cart btn  btn-outline-dark btn-lg"></i></a>
                            <a type="button" class="btn btn-outline-dark  btn-lg" asp-controller="Product" asp-action="Product" asp-route-id=@product.Id>more info</a>
                        </div>

                        <img class="card-img-top show"src=@product.Image
                             alt="100%x280" onerror="this.onerror = null;this.src = '/img/Razor Cosmetics placeholder.png';"/>





                    </div>
                    <div class="part-2 card-body  center text-center">
                        <h3 class="product-title">@product.Name</h3>

                        @if (product.Brand == "NULL")
                        {
                            <h6 class="product-subtitle mb-2 text-muted"> By: <strong>Static Void Cosmetics</strong></h6>
                        }
                        else
                        {
                            <h6 class="product-subtitle mb-2 text-muted"> By: <strong>@product.Brand</strong></h6>
                        }


                        <h4 class="product-price">@product.Price &euro;</h4>
                        @if (product.Rating != null)
                        {
                            var ratingCount = @product.Rating;

                            RatingStars(ratingCount);

                        }


                    </div>

                </div>
            </div>

        }
    }
    async Task RenderRecommended()
    {
        var recommendedList = _ProductHandler.GetRecommendedProducts("lipstick", 12).Result.AsEnumerable();


        foreach (var product in @recommendedList)
        {

            <!-- Single Product -->
            <div class="col-md-6 col-lg-4 col-xl-3">
                <div id="product-1" class="single-product">
                    <div class="part-1">
                     
                        <img class=" card-img-top "src=@product.Image
                             alt="100%x280" onerror="this.onerror = null;this.src = '/img/Razor Cosmetics placeholder.png';"/>

                    </div>
                    <div class="part-2 center text-center">
                        <h3 class="product-title">@product.Name</h3>

                        <h4 class="product-title"> By: @product.Brand</h4>

                        <h4 class="product-price">@product.Price &euro;</h4>
                        
                        @if (product.Rating != null)
                        {
                            var ratingCount = @product.Rating;
                            
                            RatingStars(ratingCount);
                               
                        }

                        <div class="btn-group justify-content-center">
                            <a href="#"><i class="bi bi-cart btn btn-outline-dark btn-lg"></i></a>
                            <a type="button" class="btn btn-outline-dark btn-lg" asp-controller="Product" asp-action="Product" asp-route-id=@product.Id>more info</a>
                        </div>
                    </div>
                </div>
            </div>

        }
    }



   async Task RenderByBrand()
    {

        var fromBrandList =  _ProductHandler.GetProductsByBrand("maybelline", 11).Result.AsEnumerable();



        foreach (var product in @fromBrandList)
        {

            <!-- Single Product -->
            <div class="col-md-6 col-lg-4 col-xl-3">
                <div id="product-1" class="single-product">
                    <div class="part-1">
                        
                        <img class=" card-img-top "src=@product.Image
                             alt="100%x280" onerror="this.onerror = null;this.src = '/img/Razor Cosmetics placeholder.png';"/>
                    </div>
                    <div class="part-2 center text-center">
                        <h3 class="product-title">@product.Name</h3>

                        <h4 class="product-title"> By: @product.Brand</h4>

                        <h4 class="product-price">@product.Price &euro;</h4>
                        
                        @if (product.Rating != null)
                        {
                            var ratingCount = @product.Rating;
                            
                            
                           RatingStars(ratingCount);
                               
                        }

                        <div class="btn-group justify-content-center">
                            <a href="#"><i class="bi bi-cart btn btn-outline-dark btn-lg"></i></a>
                            <a type="button" class="btn btn-outline-dark btn-lg" asp-controller="Product" asp-action="Product" asp-route-id=product.Id>more info</a>
                        </div>
                    </div>
                </div>
            </div>
           
        }
       

    }
}






<section class="header d-flex justify-content-center container-fluid w-100">
    <div class="card background-img bg-transparent text-center justify-self-center text- px-3 header-img my-2">
        <h1>
           
        </h1>
        <p>
           <pre>
“Calliope leaned forward on the vanity,
which was littered with gleaming silver beauty wands and powders
- and a fresh manicolor mitt—all of it arrayed carefully before her,
like weapons polished and laid out for battle.
Her own lethal tools, which had always made her so dangerously beautiful.” – Katharine McGee
      </pre>

       </p>
    </div>

</section>

<section class="section-products">
    <div class="container">
        <div class="g-3">


        <div class="row justify-content-center text-center">
            <div class="col-md-8 col-lg-6">
                <div class="header">
                    <h2>Popular Products</h2>
                </div>
            </div>
        </div>

        <div class="row">

            @{
                await RenderMostPopular();
            }

        </div>

        </div>
        <div class="row justify-content-center text-center">
            <div class="col-md-8 col-lg-6">
                <div class="header header-img w-100
">
                    <h2>Recommended for you</h2>
                </div>
            </div>
        </div>

        <div class="row">
            @{
                await RenderRecommended();
            }


        </div>


        <div class="row justify-content-center text-center">
            <div class="col-md-8 col-lg-6">
                <div class="header">
                    <h2>By Maybelline</h2>
                </div>
            </div>
        </div>
        <div class="row">
            @{
                await RenderByBrand();
            }


        </div>


    </div>
</section>